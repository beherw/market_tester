let i=null,e=null,l=null;async function m(o=null){if(i)return i;if(e)try{return await e}catch{e=null}if(l)throw l;const u=new Promise((r,n)=>{const E=setTimeout(()=>{n(new Error("加載超時：extracts.json 檔案過大，請稍後再試或檢查網路連線"))},3e4);o&&o.addEventListener("abort",()=>{clearTimeout(E),n(new Error("請求已取消"))})}),s=(async()=>{const r="/market_tester/",n=`${r}data/extracts.json`,E=`${r}teamcraft_git/libs/data/src/lib/extracts/extracts.json`,a=new AbortController;o&&o.addEventListener("abort",()=>a.abort());const c=setTimeout(()=>a.abort(),3e4);try{let t=await fetch(n,{signal:a.signal,headers:{Accept:"application/json"}});if(t.ok)clearTimeout(c),console.log("Loaded optimized extracts.json from public/data");else if(t.status===404){console.warn("Optimized extracts.json not found, trying original..."),clearTimeout(c);const T=setTimeout(()=>a.abort(),6e4);t=await fetch(E,{signal:a.signal,headers:{Accept:"application/json"}}),clearTimeout(T)}else throw clearTimeout(c),new Error(`HTTP ${t.status}: ${t.statusText}`);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return i=await t.json(),l=null,i}catch(t){throw clearTimeout(c),t.name==="AbortError"?new Error("加載超時：extracts.json 檔案過大，請稍後再試"):t}})();e=Promise.race([s,u]);try{return await e}catch(r){throw l=r,e=null,r}finally{e=null}}async function d(o,u=null){try{const r=(await m(u))[o];return!r||!r.sources?[]:r.sources||[]}catch(s){return console.error("Failed to load extracts.json:",s),[]}}const S={DEPRECATED:0,CRAFTED_BY:1,TRADE_SOURCES:2,VENDORS:3,REDUCED_FROM:4,DESYNTHS:5,INSTANCES:6,GATHERED_BY:7,VENTURES:8,TREASURES:9,QUESTS:10,FATES:11,GARDENING:12,MOGSTATION:13,ISLAND_PASTURE:14,ISLAND_CROP:15,VOYAGES:16,REQUIREMENTS:17,MASTERBOOKS:18,ALARMS:19,ACHIEVEMENTS:22};export{S as D,d as g,m as l};
