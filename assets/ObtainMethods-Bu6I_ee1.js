import{g as z,_ as X}from"./services-data-DOFC0cEd.js";import{r as w,j as e,u as bt}from"./react-vendor-DmEpS5Kz.js";import{g as yt,D as d}from"./extractsService-D72l7IXV.js";import{t as Ee,a as wt,b as Dt,c as be,d as Le,e as We,f as St,g as At,h as Xe,i as Et}from"./data-tw-other-De0qaQHL.js";import{t as T}from"./data-tw-items-4ChDDRSh.js";import{m as Ze,f as $e,a as ie,q as Te,l as ye,b as Lt,i as Je,p as $t}from"./data-other-BAzrwk9S.js";import{f as Y}from"./data-db-CylQINsK.js";import{I as Q}from"./index-_u_x4PTc.js";import"./opencc-C1Qz6KEM.js";import"./data-tw-descriptions-CJIEoqIq.js";import"./vendor-dPMYpV4t.js";import"./axios-B9ygI19o.js";function Ke(N,p=100,U=0){return(N-1)*p/40.96+U}function Tt({isOpen:N,onClose:p,zoneName:U,x:H,y,npcName:k,mapId:Z}){const[we,J]=w.useState(!0),[q,O]=w.useState(null),[se,ae]=w.useState(100),[pe,ue]=w.useState(0),[le,ce]=w.useState(0);if(w.useEffect(()=>{if(!N){O(null),J(!0);return}O(null),J(!0);const _=setTimeout(()=>{if(Z&&Ze[Z]){const K=Ze[Z];O(K.image),ae(K.size_factor||100),ue(K.offset_x||0),ce(K.offset_y||0),J(!1)}else O(null),J(!1)},50);return()=>clearTimeout(_)},[N,Z]),w.useEffect(()=>{const _=K=>{K.key==="Escape"&&p()};return N&&(document.addEventListener("keydown",_),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",_),document.body.style.overflow=""}},[N,p]),!N)return null;const B=Ke(H,se,pe),De=Ke(y,se,le);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",onClick:p,children:e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 max-w-lg w-full max-h-[90vh] overflow-hidden",onClick:_=>_.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:U}),k&&e.jsx("p",{className:"text-sm text-gray-400",children:k})]}),e.jsx("button",{onClick:p,className:"p-1 rounded hover:bg-slate-700 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"relative aspect-square bg-slate-900",children:we?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-400 border-t-purple-600"})}):q?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:q,alt:U,className:"w-full h-full object-contain",onError:_=>{_.target.style.display="none"}},`${Z}-${H}-${y}`),e.jsx("div",{className:"absolute pointer-events-none",style:{left:`${B}%`,top:`${De}%`,width:"24px",height:"24px",transform:"translate(-50%, -100%)",zIndex:10},children:e.jsx("svg",{className:"w-full h-full text-red-500 drop-shadow-lg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 0C7.58 0 4 3.58 4 8c0 5.25 8 13 8 13s8-7.75 8-13c0-4.42-3.58-8-8-8zm0 11c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"})})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsx("p",{children:"地圖暫無法顯示"}),e.jsxs("p",{className:"text-xs mt-1",children:["(",U,")"]})]})})}),e.jsxs("div",{className:"p-4 border-t border-slate-700 bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-ffxiv-gold font-medium",children:["X: ",H.toFixed(1)]}),e.jsxs("span",{className:"text-ffxiv-gold font-medium",children:["Y: ",y.toFixed(1)]})]}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-2",children:"點擊外部或按 ESC 關閉"})]})]})})}let ke=null,Re=null,Me=null,Fe=null,Ce=null,_e=null,Ve=null,Pe=null,Ie=null;const kt=async()=>(ke||(ke=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.n),[])).default),ke),Rt=async()=>(Re||(Re=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.s),[])).default),Re),Mt=async()=>(Me||(Me=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.j),[])).default),Me),Ft=async()=>(Fe||(Fe=(await X(()=>import("./data-other-BAzrwk9S.js").then(p=>p.k),[])).default),Fe),Ct=async()=>(Ce||(Ce=(await X(()=>import("./data-zh-BCesDonN.js").then(p=>p.a),[])).default),Ce),_t=async()=>(_e||(_e=(await X(()=>import("./data-zh-BCesDonN.js").then(p=>p.b),[])).default),_e),Vt=async()=>(Ve||(Ve=(await X(()=>import("./data-zh-BCesDonN.js").then(p=>p.c),[])).default),Ve),Pt=async()=>(Pe||(Pe=(await X(()=>import("./data-db-CylQINsK.js").then(p=>p.n),[])).default),Pe),It=async()=>(Ie||(Ie=(await X(()=>import("./data-db-CylQINsK.js").then(p=>p.q),[])).default),Ie);function Jt({itemId:N,onItemClick:p,onExpandCraftingTree:U,isCraftingTreeExpanded:H=!1}){const y=bt(),[k,Z]=w.useState([]),[we,J]=w.useState(!0),[q,O]=w.useState({isOpen:!1,zoneName:"",x:0,y:0,npcName:"",mapId:null}),[se,ae]=w.useState(null),[pe,ue]=w.useState({x:0,y:0}),[le,ce]=w.useState(null),[B,De]=w.useState(null),[_,K]=w.useState(null),[de,et]=w.useState(null),[fe,tt]=w.useState(null),[he,st]=w.useState(null),[ge,nt]=w.useState(null),[Se,at]=w.useState(null),[ee,lt]=w.useState(null),[ve,rt]=w.useState(null);if(w.useEffect(()=>{if(!N)return;J(!0),ce(null);const s=new AbortController;return yt(N,s.signal).then(l=>{if(s.signal.aborted)return;const h=l.some(t=>t.type===d.FATES);l=l.filter(t=>t.type!==d.ISLAND_PASTURE),l=l.filter(t=>t.type===d.FATES&&Array.isArray(t.data)?t.data.some(o=>{if(typeof o=="object"&&(o.nodeId!==void 0||o.itemId!==void 0)&&o.id===void 0)return!1;const a=typeof o=="object"?o.id:o;if(!a||typeof a!="number")return!1;const r=Ee[a],x=$e[a],m=Y[a]||Y[String(a)];return r||x||m}):!0);const g=ie[N]||ie[String(N)];if(g){const t=g,n=new Set;if(h){const a=l.find(r=>r.type===d.FATES);a&&Array.isArray(a.data)&&a.data.forEach(r=>{const x=typeof r=="object"?r.id:r;x&&n.add(x)})}const o=t.filter(a=>!n.has(a));if(o.length>0){const a=o.map(r=>{const x=Y[r]||Y[String(r)];return x?{id:r,level:x.lvl||x.lvlMax||0,zoneId:x.zoneid,mapId:x.map,coords:x.x!==void 0&&x.y!==void 0?{x:x.x,y:x.y}:null}:null}).filter(Boolean);if(a.length>0)if(h){const r=l.find(x=>x.type===d.FATES);r&&(r.data=[...r.data||[],...a])}else l.push({type:d.FATES,data:a})}}const c=l.some(t=>t.type===d.FATES);Object.keys(Y).forEach(t=>{const n=Y[t];if(!n)return;const o=parseInt(t,10),r=(Array.isArray(n.items)?n.items:[]).includes(N);let x=!1;if(c){const j=l.find(v=>v.type===d.FATES);j&&Array.isArray(j.data)&&(x=j.data.some(v=>(typeof v=="object"?v.id:v)===o))}const m=ie[N]||ie[String(N)],u=m&&m.includes(o);if((r||u)&&!x){const j={id:o,level:n.lvl||n.lvlMax||0,zoneId:n.zoneid,mapId:n.map,coords:n.x!==void 0&&n.y!==void 0?{x:n.x,y:n.y}:null};if(c){const v=l.find(L=>L.type===d.FATES);v?v.data=[...v.data||[],j]:l.push({type:d.FATES,data:[j]})}else l.push({type:d.FATES,data:[j]})}});const A=l.some(t=>t.type===d.QUESTS),i=[];if(Object.keys(Te).forEach(t=>{const n=Te[t];if(!n||!n.rewards)return;n.rewards.some(a=>a.id===N)&&i.push(parseInt(t,10))}),i.length>0)if(A){const t=l.find(n=>n.type===d.QUESTS);if(t&&Array.isArray(t.data)){const n=new Set(t.data.map(a=>typeof a=="object"?a.id:a)),o=i.filter(a=>!n.has(a));o.length>0&&(t.data=[...t.data,...o])}}else{const t=l.find(n=>n.type===d.MASTERBOOKS);if(t&&Array.isArray(t.data))if(t.data.every(o=>{const a=typeof o=="object"?o.id:o;return typeof a=="number"&&a>1e3&&a<1e6})){t.type=d.QUESTS;const o=new Set(t.data.map(r=>typeof r=="object"?r.id:r)),a=i.filter(r=>!o.has(r));a.length>0&&(t.data=[...t.data,...a])}else l.push({type:d.QUESTS,data:i});else l.push({type:d.QUESTS,data:i})}if(ye[N]&&Array.isArray(ye[N])&&ye[N].length>0){const t=ye[N],n=l.some(a=>a.type===d.TREASURES),o=t.filter(a=>{const r=T[a];return r&&r.tw});if(o.length>0)if(n){const a=l.find(r=>r.type===d.TREASURES);if(a&&Array.isArray(a.data)){const r=new Set(a.data.map(m=>typeof m=="object"?m.id:m)),x=o.filter(m=>!r.has(m));x.length>0&&(a.data=[...a.data,...x])}}else l.push({type:d.TREASURES,data:o})}Z(l||[]),J(!1)}).catch(l=>{s.signal.aborted||(console.error("Failed to load sources:",l),Z([]),J(!1),l.message&&(l.message.includes("超時")||l.message.includes("timeout")||l.message.includes("過大"))&&console.warn("extracts.json 載入超時，這可能是因為檔案過大或網路連線較慢。取得方式資訊可能無法顯示。"))}),()=>{s.abort()}},[N]),w.useEffect(()=>{fe||Ft().then(s=>tt(s))},[fe]),w.useEffect(()=>{!he&&k.some(s=>s.type===d.INSTANCES)&&Ct().then(s=>st(s))},[k,he]),w.useEffect(()=>{!ge&&k.some(s=>s.type===d.QUESTS)&&_t().then(s=>nt(s))},[k,ge]),w.useEffect(()=>{!Se&&k.some(s=>s.type===d.FATES)&&Vt().then(s=>at(s))},[k,Se]),w.useEffect(()=>{!B&&k.some(s=>s.type===d.VENDORS||s.type===d.QUESTS)&&kt().then(s=>De(s))},[k,B]),w.useEffect(()=>{!_&&k.some(s=>s.type===d.VENDORS||s.type===d.TRADE_SOURCES)&&Rt().then(s=>K(s))},[k,_]),w.useEffect(()=>{!de&&k.some(s=>s.type===d.VENDORS||s.type===d.TRADE_SOURCES)&&Mt().then(s=>et(s))},[k,de]),w.useEffect(()=>{!ee&&k.some(s=>s.type===d.VENDORS||s.type===d.QUESTS)&&Pt().then(s=>lt(s))},[k,ee]),w.useEffect(()=>{!ve&&k.some(s=>s.type===d.QUESTS)&&It().then(s=>rt(s))},[k,ve]),we)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-ffxiv-gold"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"載入取得方式..."})]});if(k.length===0){const l=T[N]?.tw||"",h=l&&l.includes("地圖");return e.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:h?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{children:"暫無取得方式資料"}),e.jsxs("a",{href:"https://cycleapple.github.io/xiv-tc-treasure-finder/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-ffxiv-gold/20 hover:bg-ffxiv-gold/30 border border-ffxiv-gold/50 hover:border-ffxiv-gold text-ffxiv-gold rounded-lg transition-all duration-200 text-sm font-medium",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"前往藏寶圖查詢器"]})]}):e.jsx("div",{children:"暫無取得方式資料"})})}const ot=s=>({[d.CRAFTED_BY]:"製作",[d.TRADE_SOURCES]:"兌換",[d.VENDORS]:"NPC商店",[d.TREASURES]:"寶箱/容器",[d.INSTANCES]:"副本掉落",[d.DESYNTHS]:"精製獲得",[d.QUESTS]:"任務獎勵",[d.FATES]:"危命任務",[d.GATHERED_BY]:"採集獲得",[d.REDUCED_FROM]:"分解獲得",[d.VENTURES]:"遠征獲得",[d.GARDENING]:"園藝獲得",[d.MOGSTATION]:"商城購買",[d.ISLAND_CROP]:"島嶼作物",[d.VOYAGES]:"遠征",[d.REQUIREMENTS]:"需求",[d.MASTERBOOKS]:"製作書",[d.ALARMS]:"鬧鐘提醒",[d.ACHIEVEMENTS]:"成就獎勵"})[s]||"未知",Ne=s=>St[s]?.tw||`NPC ${s}`,it=s=>{const l=Xe[s]||Xe[String(s)];if(l?.tw)return l.tw;if(ee){const h=ee[s]||ee[String(s)];if(h?.title?.zh)return h.title.zh}return null},re=s=>{const l=At[s];return l?.tw?l.tw:$t[s]?.en||`Zone ${s}`},ct=s=>{const l=We[s];return l?.tw?l.tw:null},ze=s=>{if(!s)return null;if(s.tw)return s.tw;if(s.zh)return s.zh;if(s.en&&fe){for(const[l,h]of Object.entries(fe))if(h?.en===s.en){const g=We[l];if(g?.tw)return g.tw}}return null},dt=s=>{if(!s)return"貨幣";const l=T[s];return l?.tw?l.tw:null},je=s=>{if(!s)return null;const l=s.toString(),h=wt[l],g=Dt[l],c=Lt[l];return h?.tw?{id:s,name:h.tw,description:g?.tw||null,icon:c?.icon?`https://xivapi.com${c.icon}`:null,itemReward:c?.itemReward||null,title:c?.title||null,nameEn:c?.en||null,nameJa:c?.ja||null}:null},Be=(s,l)=>{const h=s.currentTarget.getBoundingClientRect();ue({x:h.left+h.width/2,y:h.top}),ae(l)},Oe=s=>{if(se){const l=s.currentTarget.getBoundingClientRect();ue({x:l.left+l.width/2,y:l.top})}},Qe=()=>{ae(null)},xe=[];k.forEach(s=>{(s.type===d.ACHIEVEMENTS||s.type===19)&&Array.isArray(s.data)&&xe.push(...s.data)});const xt=s=>{const l=Et[s];if(l?.tw)return l.tw;const h=Je[s];return h?.en?h.en:`副本 ${s}`},mt=s=>he&&he[s]?.zh||null,Ue=s=>ge&&ge[s]?.zh||null,qe=s=>s&&s.replace(/[\uE000-\uF8FF\u200B-\u200D\uFEFF]/g,"").trim(),pt=(s,l,h)=>{if(!s)return null;if(h&&h.requiredQuest)return h.requiredQuest;if(_){const g=Array.isArray(_)?_.find(c=>c.id===s):_[s];if(g&&g.requiredQuest)return g.requiredQuest}if(l&&de&&de[l]){const g=de[l],c=Array.isArray(g)?g.find(A=>A.id===s):g[s];if(c&&c.requiredQuest)return c.requiredQuest}return null},Ae=s=>s.toLocaleString("zh-TW"),ut=s=>({8:"CRP",9:"BSM",10:"ARM",11:"GSM",12:"LTW",13:"WVR",14:"ALC",15:"CUL"})[s],ft=s=>Le[s]?.tw||`職業 ${s}`,ht=s=>{const l=ut(s);return l?`https://garlandtools.org/files/icons/job/${l}.png`:null},gt=s=>{if(!s)return null;const l=typeof s=="string"?parseInt(s,10):s;return T[l]?.tw||null},vt=(s,l,h=!0)=>{const{type:g,data:c}=s,A=h?"flex-1":"";if(g===d.CRAFTED_BY)return!c||c.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/000000/000501.png",alt:"Craft",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"製作"}),U&&e.jsxs("button",{onClick:i=>{i.preventDefault(),i.stopPropagation(),U()},className:`ml-auto px-2 py-1 text-xs border rounded transition-all duration-200 flex items-center gap-1 ${H?"bg-amber-900/50 hover:bg-amber-800/70 border-ffxiv-gold/60 hover:border-ffxiv-gold text-ffxiv-gold":"bg-purple-900/50 hover:bg-purple-800/70 border-purple-500/40 hover:border-purple-400/60 text-purple-200 hover:text-ffxiv-gold"}`,title:H?"收起製作價格樹":"展開製作價格樹",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),H?"收起樹":"展開樹"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((i,t)=>{const n=i.job,o=ft(n),a=ht(n),r=i.lvl||i.rlvl||0,x=i.stars_tooltip||"";return!o||o===`職業 ${n}`?null:e.jsx("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),U&&U()},className:`w-[280px] flex-grow-0 rounded p-2 min-h-[70px] flex flex-col justify-center transition-all duration-200 cursor-pointer ${H?"bg-amber-900/30 hover:bg-amber-800/40 border border-ffxiv-gold/40":"bg-slate-900/50 hover:bg-slate-800/70"}`,title:H?"點擊收起製作價格樹":"點擊展開製作價格樹",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx("img",{src:a,alt:o,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:o}),r>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:["Lv.",r]}),x&&e.jsx("span",{className:"text-xs text-yellow-400",children:x})]}),i.masterbook&&(()=>{const m=i.masterbook.id?typeof i.masterbook.id=="string"?parseInt(i.masterbook.id,10):i.masterbook.id:null,E=(m?gt(m):i.masterbook.name?.tw||i.masterbook.name?.en)||"專用配方書";return e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["專用配方書:"," ",m?e.jsx("button",{onClick:j=>{j.preventDefault(),j.stopPropagation(),p?z(m).then(v=>{v?p(v):y(`/item/${m}`)}):y(`/item/${m}`)},className:"text-ffxiv-gold hover:text-yellow-400 hover:underline transition-colors",children:E}):e.jsx("span",{children:E})]})})()]})]})},`craft-${l}-${t}`)}).filter(Boolean)})]},`crafted-${l}`);if(g===d.TRADE_SOURCES){if(!c||c.length===0)return null;const i=[];return c.forEach((t,n)=>{const a=t.trades?.[0]?.currencies?.[0],r=a?.id,x=a?.amount,m=a?.hq===!0,u=t.id;let E=dt(r);if(!E&&r)return;const j=r?T[r]:null,v=j&&j.tw;let L=null;if(t.shopName)L=t.shopName.tw||t.shopName.zh||null;else if(t.id){const D=ct(t.id);D&&(L=D)}const b=t.npcs?.filter(D=>{const C=typeof D=="object"?D.id:D,M=Ne(C);return M&&M!==`NPC ${C}`})||[];b.length===0||!E||b.forEach(D=>{i.push({npc:D,currencyItemId:r,currencyName:E,currencyAmount:x,requiresHQ:m,hasCurrencyItem:v,shopName:L,shopId:u,tradeSource:t})})}),i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"兌換"})}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const o=t.npc,a=typeof o=="object"?o.id:o,r=Ne(a),x=typeof o=="object"?o.zoneId:null,m=typeof o=="object"?o.coords:null,u=typeof o=="object"?o.mapId:null,E=x?re(x):"",j=m&&m.x!==void 0&&m.y!==void 0,v=pt(t.shopId,a,t.tradeSource),L=v?be[v]?.tw||be[v]?.en:null;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.hasCurrencyItem?e.jsxs("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),p?z(t.currencyItemId).then(D=>{D?p(D):y(`/item/${t.currencyItemId}`)}):y(`/item/${t.currencyItemId}`)},className:"flex items-center gap-1.5 font-medium text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:t.currencyItemId,alt:t.currencyName,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:t.currencyName}),t.requiresHQ&&e.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/50 rounded text-[10px] font-bold text-yellow-400",title:"需要高品質版本",children:"HQ"})]}):e.jsxs("span",{className:"font-medium text-white flex items-center gap-1.5",children:[t.currencyName,t.requiresHQ&&e.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 bg-yellow-500/20 border border-yellow-500/50 rounded text-[10px] font-bold text-yellow-400",title:"需要高品質版本",children:"HQ"})]}),e.jsxs("span",{className:"text-yellow-400 text-sm",children:["x",t.currencyAmount]})]}),e.jsx("div",{className:"text-sm text-gray-300",children:r}),t.shopName&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:t.shopName}),v&&L&&e.jsxs("div",{className:"text-xs text-pink-400/90 mt-1 flex items-center gap-1",children:[e.jsx("span",{children:"需要完成任務："}),e.jsx("button",{onClick:b=>{b.preventDefault(),b.stopPropagation();const D=Ue(v);D&&window.open(`https://ff14.huijiwiki.com/wiki/任务:${encodeURIComponent(D)}`,"_blank")},className:"text-yellow-400/90 hover:text-yellow-300 hover:underline transition-colors",children:L})]}),E&&j&&e.jsxs("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),O({isOpen:!0,zoneName:E,x:m.x,y:m.y,npcName:r,mapId:u})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[E,e.jsxs("span",{className:"ml-2",children:["X: ",m.x.toFixed(1)," - Y: ",m.y.toFixed(1)]})]})]})]},`npc-${n}`)})})]},`trade-${l}`)}if(g===d.VENDORS){const i={};c.forEach(n=>{const o=n.npcId;i[o]||(i[o]=[]),i[o].push(n)});const t=Object.keys(i).map(n=>({npcId:n,vendors:i[n]}));return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/065000/065002.png",alt:"Gil",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"NPC商店"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:t.map((n,o)=>{const a=n.vendors,r=a[0],x=Ne(r.npcId);let m=r.zoneId,u=r.coords,E=r.mapId;if((!m||!u||u.x===void 0||u.y===void 0)&&r.npcId&&B){const S=B[r.npcId]||B[String(r.npcId)];S?.position&&(m=m||S.position.zoneid,E=E||S.position.map,(!u||u.x===void 0||u.y===void 0)&&(u={x:S.position.x,y:S.position.y}))}!m&&!u&&(x?.includes("古董商")||x?.includes("journeyman salvager")||r.npcId>=1025e3&&r.npcId<1026e3)&&(m=1160,u={x:0,y:0},E=null),m&&(!u||u.x===void 0||u.y===void 0)&&(u={x:0,y:0});const v=m?re(m):"",L=v&&u&&u.x!==void 0&&u.y!==void 0,b=L&&E&&(u.x!==0||u.y!==0),D=a.map(S=>ze(S.shopName)).filter(Boolean),C=[...new Set(D)],M=xe.length>0||a.some(S=>{const W=ze(S.shopName);return S.shopName&&(S.shopName.en?.toLowerCase().includes("achievement")||S.shopName.en?.toLowerCase().includes("reward")||W?.includes("成就"))}),f=a.map(S=>S.price).filter(Boolean),F=f.length>0?Math.min(...f):null,P=f.length>0?Math.max(...f):null,G=F!==null&&P!==null&&F!==P;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:x}),(()=>{const S=it(r.npcId);return S?e.jsxs("span",{className:"text-xs text-gray-400",children:["<",S,">"]}):null})()]}),F&&e.jsxs("span",{className:"text-yellow-400 text-sm",children:[G?`${Ae(F)} - ${Ae(P)}`:Ae(F)," Gil"]})]}),C.length>0&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:C.join(", ")}),M&&xe.length>0&&(()=>{const S=je(xe[0]);return S?e.jsxs("div",{className:"text-xs mt-1 flex items-start gap-1 relative",onMouseEnter:W=>Be(W,xe[0]),onMouseMove:Oe,onMouseLeave:Qe,children:[e.jsx("span",{className:"text-pink-400/90",children:"需要完成成就："}),e.jsx("span",{className:"font-medium text-yellow-400/90 cursor-help underline decoration-dotted decoration-yellow-400/50 hover:decoration-yellow-400 transition-colors",children:S.name})]}):null})(),L&&(b?e.jsxs("button",{onClick:()=>O({isOpen:!0,zoneName:v,x:u.x,y:u.y,npcName:x,mapId:E}),className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[v,e.jsxs("span",{className:"ml-2",children:["X: ",u.x.toFixed(1)," - Y: ",u.y.toFixed(1)]})]})]}):e.jsxs("div",{className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-slate-700/50 text-xs text-blue-400",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[v,e.jsxs("span",{className:"ml-2",children:["X: ",u.x.toFixed(1)," - Y: ",u.y.toFixed(1)]})]})]}))]},o)})})]},`vendor-${l}`)}if(g===d.TREASURES)return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061808.png",alt:"Treasure",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"寶箱/容器"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((i,t)=>{const n=T[i];if(!n||!n.tw)return null;const o=n.tw;return e.jsxs("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),p?z(i).then(r=>{r?p(r):y(`/item/${i}`)}):y(`/item/${i}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:i,alt:o,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:o})]},t)}).filter(Boolean)})]},`treasure-${l}`);if(g===d.INSTANCES)return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061801.png",alt:"Instance",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"副本掉落"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((i,t)=>{const n=xt(i);if(n===`副本 ${i}`)return null;const o=mt(i),a=Je[i];let x=a?.icon?`https://xivapi.com${a.icon}`:"https://xivapi.com/i/061000/061801.png";return a?.contentType&&(a.contentType===4?x="https://xivapi.com/i/061000/061804.png":a.contentType===5?x="https://xivapi.com/i/061000/061802.png":a.contentType===28?x="https://xivapi.com/i/061000/061832.png":a.contentType===21&&(x="https://xivapi.com/i/061000/061824.png")),e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:o?e.jsxs("a",{href:`https://ff14.huijiwiki.com/wiki/${encodeURIComponent(o)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 group",onClick:m=>m.stopPropagation(),children:[e.jsx("img",{src:x,alt:"Instance",className:"w-7 h-7"}),e.jsx("span",{className:"text-sm text-blue-400 group-hover:text-ffxiv-gold transition-colors flex items-center gap-1",children:n})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:x,alt:"Instance",className:"w-7 h-7"}),e.jsx("span",{className:"text-sm text-gray-300",children:n})]})},t)}).filter(Boolean)})]},`instance-${l}`);if(g===d.DESYNTHS){const i=c.filter(t=>{const n=T[t];return n&&n.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/000000/000120.png",alt:"Desynth",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"精製獲得"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:i.map((t,n)=>{const a=T[t]?.tw;return a?e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(t).then(x=>{x?p(x):y(`/item/${t}`)}):y(`/item/${t}`)},className:"flex flex-col items-center gap-1.5 p-2 rounded-lg bg-slate-900/50 border border-slate-700/50 hover:border-ffxiv-gold/60 hover:bg-slate-800/70 transition-all duration-200 group",children:[e.jsx(Q,{itemId:t,alt:a,className:"w-10 h-10 object-contain rounded border border-slate-700/50 group-hover:border-ffxiv-gold/60 transition-colors duration-200"}),e.jsx("span",{className:"text-xs text-blue-400 group-hover:text-ffxiv-gold text-center line-clamp-2 transition-colors duration-200",title:a,children:a})]},n):null})})]},`desynth-${l}`)}if(g===d.QUESTS){const i=c.filter(t=>{const n=be[t];return n&&n.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060453.png",alt:"Quest",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"任務獎勵"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const a=be[t]?.tw,r=qe(a);if(!r)return null;const x=Te[t],m=x?.icon?`https://xivapi.com${x.icon}`:"https://xivapi.com/i/060000/060453.png",u=Ue(t),E=qe(u),j=ve?ve[t]:null,v=j?.level||null,L=j?.jobCategory||null,b=j?.start||null,D=b?Ne(b):null;let C="";L===1?C="所有職業":L&&Le[L]&&(C=Le[L].tw||"");let M=null,f=null,F=null;const P=j?.startingPoint||null;if(P&&(M=P.zoneid||null,F=P.map||null,P.x!==void 0&&P.y!==void 0&&(f={x:P.x,y:P.y})),(!M||!f||f.x===void 0||f.y===void 0)&&b&&B){const R=B[b]||B[String(b)];R?.position&&(M=M||R.position.zoneid,F=F||R.position.map,(!f||f.x===void 0||f.y===void 0)&&(f={x:R.position.x,y:R.position.y}))}if((!M||!f||f.x===void 0||f.y===void 0)&&b&&ee){const R=ee[b]||ee[String(b)];R?.position&&(M=M||R.position.zoneid,F=F||R.position.map,(!f||f.x===void 0||f.y===void 0)&&(f={x:R.position.x,y:R.position.y}))}if((!M||!f||f.x===void 0||f.y===void 0)&&j?.npcs&&B)for(const R of j.npcs){const ne=B[R]||B[String(R)];if(ne?.position){M=M||ne.position.zoneid,F=F||ne.position.map,(!f||f.x===void 0||f.y===void 0)&&(f={x:ne.position.x,y:ne.position.y});break}}const G=M?re(M):"",S=G&&f&&f.x!==void 0&&f.y!==void 0,W=S&&F&&(f.x!==0||f.y!==0);return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:m,alt:"Quest",className:"w-7 h-7 object-contain flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:E?e.jsx("a",{href:`https://ff14.huijiwiki.com/wiki/任务:${encodeURIComponent(E)}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-400 hover:text-ffxiv-gold hover:underline transition-colors cursor-pointer",onClick:R=>R.stopPropagation(),children:r}):e.jsx("span",{className:"text-sm font-medium text-gray-300",children:r})})]}),e.jsxs("div",{className:"space-y-1 mt-1 text-xs text-gray-400",children:[(v||C)&&e.jsxs("div",{className:"flex items-center gap-2",children:[C&&e.jsx("span",{children:C}),v&&e.jsxs("span",{children:[v,"級"]})]}),D&&D!==`NPC ${b}`&&e.jsx("div",{className:"text-gray-400",children:D}),S&&G&&(W?e.jsxs("button",{onClick:R=>{R.preventDefault(),R.stopPropagation(),O({isOpen:!0,zoneName:G,x:f.x,y:f.y,npcName:D||r,mapId:F})},className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[G,e.jsxs("span",{className:"ml-2",children:["X: ",f.x.toFixed(1)," - Y: ",f.y.toFixed(1)]})]})]}):e.jsxs("div",{className:"mt-1 pt-1 border-t border-slate-700/50 text-xs text-gray-400",children:[G,f&&f.x!==void 0&&f.y!==void 0&&e.jsxs("span",{className:"ml-2",children:["X: ",f.x.toFixed(1)," - Y: ",f.y.toFixed(1)]})]}))]})]},n)}).filter(Boolean)})]},`quest-${l}`)}if(g===d.FATES){const i=c.filter(t=>{if(typeof t=="object"&&(t.nodeId!==void 0||t.itemId!==void 0)&&t.id===void 0)return!1;const n=typeof t=="object"?t.id:t;if(!n||typeof n!="number")return!1;const o=Ee[n],a=$e[n],r=Y[n]||Y[String(n)];return o||a||r});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060502.png",alt:"FATE",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"危命任務"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const o=typeof t=="object"?t.id:t,a=typeof t=="object"?t.level:null,r=typeof t=="object"?t.zoneId:null,x=typeof t=="object"?t.mapId:null,m=typeof t=="object"?t.coords:null,u=Ee[o],E=Se?.[o],j=u?.name?.tw||`FATE ${o}`,v=E?.name?.zh||j,L=$e[o],b=L?.icon?`https://xivapi.com${L.icon}`:"https://xivapi.com/i/060000/060502.png",D=r?re(r):"",C=m&&m.x!==void 0&&m.y!==void 0&&x,f=(Y[o]||Y[String(o)])?.items||[],F=f.includes(N),P=ie[N]||ie[String(N)],G=P&&P.includes(o),S=f,W=!F&&G?[N]:[],R=a&&a>=32&&b.includes("060958"),ne=`https://ff14.huijiwiki.com/wiki/${encodeURIComponent(v)}`;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:b,alt:"FATE",className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("a",{href:ne,target:"_blank",rel:"noopener noreferrer",onClick:$=>{$.stopPropagation()},className:"text-sm font-medium text-blue-400 hover:text-ffxiv-gold hover:underline transition-colors cursor-pointer",children:j}),a&&e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[D?`${D} `:"",a,"級危命任務",R&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"惡名精英"})]})]})]}),(S.length>0||W.length>0)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-700/50 w-full",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2 font-medium",children:"獎勵物品"}),e.jsx("div",{className:"w-full border border-slate-700/50 rounded-lg overflow-hidden bg-slate-900/30",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-800/50 border-b border-slate-700/50",children:[e.jsx("th",{className:"text-left text-gray-400 font-normal py-2 px-3 w-20",children:"評價"}),e.jsx("th",{className:"text-left text-gray-400 font-normal py-2 px-3",children:"獎勵物品"})]})}),e.jsxs("tbody",{children:[S.length>0&&e.jsxs("tr",{className:"border-b border-slate-700/30 bg-slate-900/30",children:[e.jsx("td",{className:"py-2.5 px-3 text-gray-300 align-top font-medium whitespace-nowrap",children:"銀牌"}),e.jsx("td",{className:"py-2.5 px-3 w-auto",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:S.map($=>{const I=T[$];return!I||!I.tw?null:e.jsxs("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),p?z($).then(te=>{te?p(te):y(`/item/${$}`)}):y(`/item/${$}`)},className:"flex items-center gap-1.5 text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:$,alt:I.tw,className:"w-5 h-5 object-contain"}),e.jsx("span",{className:"hover:underline",children:I.tw})]},`silver-${$}`)}).filter(Boolean)})})]}),S.length>0&&e.jsxs("tr",{className:"bg-slate-900/30",children:[e.jsx("td",{className:"py-2.5 px-3 text-gray-300 align-top font-medium whitespace-nowrap",children:"金牌"}),e.jsx("td",{className:"py-2.5 px-3 w-auto",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:S.map($=>{const I=T[$];return!I||!I.tw?null:e.jsxs("button",{onClick:te=>{te.preventDefault(),te.stopPropagation(),p?z($).then(Ge=>{Ge?p(Ge):y(`/item/${$}`)}):y(`/item/${$}`)},className:"flex items-center gap-1.5 text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:$,alt:I.tw,className:"w-5 h-5 object-contain"}),e.jsxs("span",{className:"hover:underline",children:[I.tw," ×5"]})]},`gold-${$}`)}).filter(Boolean)})})]}),W.length>0&&e.jsxs("tr",{className:"bg-slate-900/30",children:[e.jsx("td",{className:"py-2.5 px-3 text-gray-300 align-top font-medium whitespace-nowrap",children:"稀有"}),e.jsx("td",{className:"py-2.5 px-3 w-auto",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:W.map($=>{const I=T[$];return!I||!I.tw?null:e.jsxs("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),p?z($).then(te=>{te?p(te):y(`/item/${$}`)}):y(`/item/${$}`)},className:"flex items-center gap-1.5 text-blue-400 hover:text-ffxiv-gold transition-colors",children:[e.jsx(Q,{itemId:$,alt:I.tw,className:"w-5 h-5 object-contain"}),e.jsx("span",{className:"hover:underline",children:I.tw})]},`rare-${$}`)}).filter(Boolean)})})]})]})]})})]}),C&&e.jsxs("button",{onClick:$=>{$.preventDefault(),$.stopPropagation(),O({isOpen:!0,zoneName:D,x:m.x,y:m.y,npcName:j,mapId:x})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[D,e.jsxs("span",{className:"ml-2",children:["X: ",m.x.toFixed(1)," - Y: ",m.y.toFixed(1)]})]})]})]},n)}).filter(Boolean)})]},`fate-${l}`)}if(g===d.ISLAND_PASTURE)return null;if(g===d.GATHERED_BY){if(!c||!c.nodes||!Array.isArray(c.nodes)||c.nodes.length===0)return null;const i={0:"https://xivapi.com/i/060000/060438.png",1:"https://xivapi.com/i/060000/060437.png",2:"https://xivapi.com/i/060000/060433.png",3:"https://xivapi.com/i/060000/060432.png",4:"https://xivapi.com/i/060000/060445.png",5:"https://xivapi.com/i/060000/060465.png"},t={0:"採礦",1:"採石",2:"採伐",3:"割取",4:"釣魚",5:"潛水"},n=c.level||0,o=c.stars_tooltip||"",a=c.type!==void 0?c.type:c.nodes[0]?.type!==void 0?c.nodes[0].type:0,r=Math.abs(a),x=i[r]||i[0],m=t[r]||"採集";return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:x,alt:m,className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"採集獲得"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs("div",{className:"w-full text-sm text-gray-300 mb-2",children:[e.jsx("span",{className:"text-ffxiv-gold",children:m}),n>0&&e.jsxs("span",{className:"ml-2",children:["Lv.",n]}),o&&e.jsx("span",{className:"ml-2 text-yellow-400",children:o})]}),c.nodes.map((u,E)=>{const j=u.zoneId,v=j?re(j):"",L=u.map,b=u.x!==void 0&&u.y!==void 0?{x:u.x,y:u.y}:null,D=b&&L,C=u.level||n,M=u.limited===!0,f=u.isIslandNode===!0;return e.jsxs("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:x,alt:m,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:v||`區域 ${j}`}),!f&&C>0&&e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:["Lv.",C," ",m,M&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"限時"})]}),f&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:"島嶼採集點"})]})]}),D&&e.jsxs("button",{onClick:F=>{F.preventDefault(),F.stopPropagation(),O({isOpen:!0,zoneName:v,x:b.x,y:b.y,npcName:`${m}採集點`,mapId:L})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[v,e.jsxs("span",{className:"ml-2",children:["X: ",b.x.toFixed(1)," - Y: ",b.y.toFixed(1)]})]})]})]},E)})]})]},`gathered-${l}`)}if(g===d.REDUCED_FROM){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{const n=T[t];return n&&n.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061808.png",alt:"Reduction",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"分解獲得"})]}),e.jsx("div",{className:i.length===1?"flex justify-center gap-2 mt-2":"grid grid-cols-3 gap-2 mt-2",children:i.map((t,n)=>{const a=T[t]?.tw;return a?e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(t).then(x=>{x?p(x):y(`/item/${t}`)}):y(`/item/${t}`)},className:"flex flex-col items-center gap-1.5 p-2 rounded-lg bg-slate-900/50 border border-slate-700/50 hover:border-ffxiv-gold/60 hover:bg-slate-800/70 transition-all duration-200 group",children:[e.jsx(Q,{itemId:t,alt:a,className:"w-10 h-10 object-contain rounded border border-slate-700/50 group-hover:border-ffxiv-gold/60 transition-colors duration-200"}),e.jsx("span",{className:"text-xs text-blue-400 group-hover:text-ffxiv-gold text-center line-clamp-2 transition-colors duration-200",title:a,children:a})]},n):null})})]},`reduced-${l}`)}if(g===d.VENTURES){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{const n=T[t];return n&&n.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/021000/021267.png",alt:"Venture",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"遠征獲得"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const a=T[t]?.tw;return a?e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(t).then(x=>{x?p(x):y(`/item/${t}`)}):y(`/item/${t}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:t,alt:a,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:a})]},n):null}).filter(Boolean)})]},`venture-${l}`)}if(g===d.GARDENING){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{const n=typeof t=="object"?t.id:t,o=T[n];return o&&o.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/061000/061808.png",alt:"Gardening",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"園藝獲得"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const o=typeof t=="object"?t.id:t,r=T[o]?.tw;return r?e.jsxs("button",{onClick:x=>{x.preventDefault(),x.stopPropagation(),p?z(o).then(m=>{m?p(m):y(`/item/${o}`)}):y(`/item/${o}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:o,alt:r,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:r})]},n):null}).filter(Boolean)})]},`gardening-${l}`)}if(g===d.MOGSTATION)return!c||!Array.isArray(c)||c.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/065000/065002.png",alt:"Mogstation",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"商城購買"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:e.jsx("div",{className:"text-sm text-gray-300 text-center",children:"可在 Mog Station 商城購買"})})})]},`mogstation-${l}`);if(g===d.ISLAND_CROP){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{const n=T[t];return n&&n.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/063000/063950_hr1.png",alt:"Island Crop",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"島嶼作物"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const a=T[t]?.tw;return a?e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(t).then(x=>{x?p(x):y(`/item/${t}`)}):y(`/item/${t}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:t,alt:a,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:a})]},n):null}).filter(Boolean)})]},`island-crop-${l}`)}if(g===d.VOYAGES)return!c||!Array.isArray(c)||c.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/021000/021267.png",alt:"Voyage",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"遠征"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:e.jsx("div",{className:"text-sm text-gray-300 text-center",children:"可通過遠征獲得"})})})]},`voyage-${l}`);if(g===d.REQUIREMENTS){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{if(typeof t=="number"){const n=T[t];return n&&n.tw}return!1});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060453.png",alt:"Requirement",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"需求"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const a=T[t]?.tw;return a?e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(t).then(x=>{x?p(x):y(`/item/${t}`)}):y(`/item/${t}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:t,alt:a,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:a})]},n):null}).filter(Boolean)})]},`requirement-${l}`)}if(g===d.MASTERBOOKS){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{const n=T[t];return n&&n.tw});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/065000/065002.png",alt:"Masterbook",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"製作書"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const a=T[t]?.tw;return a?e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),p?z(t).then(x=>{x?p(x):y(`/item/${t}`)}):y(`/item/${t}`)},className:"w-[280px] flex-grow-0 flex items-center justify-start gap-2 text-left text-sm text-blue-400 hover:text-ffxiv-gold transition-colors bg-slate-900/50 rounded p-2 hover:bg-slate-800/70 min-h-[70px]",children:[e.jsx(Q,{itemId:t,alt:a,className:"w-7 h-7 object-contain"}),e.jsx("span",{className:"hover:underline",children:a})]},n):null}).filter(Boolean)})]},`masterbook-${l}`)}if(g===d.ALARMS){if(!c||!Array.isArray(c)||c.length===0)return null;const i={0:"https://xivapi.com/i/060000/060438.png",1:"https://xivapi.com/i/060000/060437.png",2:"https://xivapi.com/i/060000/060433.png",3:"https://xivapi.com/i/060000/060432.png",4:"https://xivapi.com/i/060000/060445.png",5:"https://xivapi.com/i/060000/060465.png"},t={0:"採礦",1:"採石",2:"採伐",3:"割取",4:"釣魚",5:"潛水"};return e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060502.png",alt:"Alarm",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"鬧鐘提醒"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((n,o)=>{if(!n||typeof n!="object")return null;const a=n.zoneId,r=a?re(a):"",x=n.mapId,m=n.coords,u=n.type!==void 0?Math.abs(n.type):0,E=i[u]||i[0],j=t[u]||"採集",v=n.duration||0,L=n.spawns||[],b=n.ephemeral===!0,D=m&&m.x!==void 0&&m.y!==void 0&&x;return e.jsxs("div",{className:"bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:E,alt:j,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:r||`區域 ${a}`}),e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[j,v>0&&e.jsxs("span",{className:"ml-1",children:["持續 ",v," 分鐘"]}),b&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"限時"}),L.length>0&&e.jsxs("span",{className:"ml-1",children:["出現時間: ",L.join(", ")]})]})]})]}),D&&e.jsxs("button",{onClick:C=>{C.preventDefault(),C.stopPropagation(),O({isOpen:!0,zoneName:r,x:m.x,y:m.y,npcName:`${j}採集點`,mapId:x})},className:"flex items-center gap-1.5 mt-2 pt-2 border-t border-slate-700/50 text-xs text-blue-400 hover:bg-slate-800/50 hover:text-blue-300 rounded px-1 py-0.5 transition-all w-full text-left",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsxs("span",{children:[r,e.jsxs("span",{className:"ml-2",children:["X: ",m.x.toFixed(1)," - Y: ",m.y.toFixed(1)]})]})]})]},o)}).filter(Boolean)})]},`alarm-${l}`)}if(g===d.ACHIEVEMENTS||g===22){if(!c||!Array.isArray(c)||c.length===0)return null;const i=c.filter(t=>{const n=je(t);return n&&n.name});return i.length===0?null:e.jsxs("div",{className:`bg-slate-800/50 rounded-lg border border-slate-700/50 p-3 ${A} min-w-[280px]`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:"https://xivapi.com/i/060000/060453.png",alt:"Achievement",className:"w-6 h-6"}),e.jsx("span",{className:"text-ffxiv-gold font-medium",children:"成就獎勵"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map((t,n)=>{const o=je(t);return o?e.jsx("div",{className:"w-[280px] flex-grow-0 bg-slate-900/50 rounded p-2 min-h-[70px] flex flex-col justify-center",onMouseEnter:a=>Be(a,t),onMouseMove:Oe,onMouseLeave:Qe,children:e.jsxs("div",{className:"flex items-center gap-2",children:[o.icon&&e.jsx("img",{src:o.icon,alt:o.name,className:"w-7 h-7 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-yellow-400 cursor-help underline decoration-dotted decoration-yellow-400/50 hover:decoration-yellow-400 transition-colors",children:o.name}),o.description&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5 line-clamp-2",children:o.description})]})]})},n):null}).filter(Boolean)})]},`achievement-${l}`)}return null},Ye=s=>{const{type:l,data:h}=s;if(!h)return 0;if(Array.isArray(h)){if(l===d.VENDORS)return new Set(h.map(c=>c.npcId)).size;if(l===d.TRADE_SOURCES){const g=new Set;return h.forEach(c=>{c.npcs?.forEach(A=>{const i=typeof A=="object"?A.id:A;i&&g.add(i)})}),g.size}return h.length}return typeof h=="object"?l===d.GATHERED_BY&&h.nodes?h.nodes.length:l===d.ALARMS&&Array.isArray(h)?h.length:1:0},me=[...k].sort((s,l)=>{const h=Ye(s);return Ye(l)-h}),Nt=le?me.filter(s=>s.type===le):me,He=[...new Set(me.map(s=>s.type))],jt=Nt.map((s,l)=>vt(s,l,!1)).filter(Boolean),V=se?je(se):null;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-ffxiv-gold flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"取得方式"]}),me.length>0&&e.jsxs("span",{className:"text-xs text-gray-400 bg-amber-900/40 px-2 py-1 rounded border border-ffxiv-gold/30",children:[me.length," 種"]}),He.length>0&&e.jsxs("div",{className:"flex items-center gap-1.5 ml-auto flex-wrap",children:[e.jsx("button",{onClick:()=>ce(null),className:`px-2 py-1 rounded-md text-xs font-medium transition-all border ${le===null?"border-ffxiv-gold bg-ffxiv-gold/20 text-ffxiv-gold":"border-gray-600 bg-slate-800/50 text-gray-400 hover:border-gray-500 hover:bg-slate-700/50"}`,children:"全部"}),He.map(s=>{const l=ot(s),h=le===s;return e.jsx("button",{onClick:()=>ce(h?null:s),className:`px-2 py-1 rounded-md text-xs font-medium transition-all border ${h?"border-ffxiv-gold bg-ffxiv-gold/20 text-ffxiv-gold":"border-gray-600 bg-slate-800/50 text-gray-400 hover:border-gray-500 hover:bg-slate-700/50"}`,children:l},s)})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3 items-start",children:jt}),se&&V&&e.jsx("div",{className:"fixed z-[9999] bg-slate-900 border-2 border-yellow-400/60 rounded-lg shadow-2xl p-4 max-w-sm pointer-events-auto",style:{left:`${pe.x}px`,top:`${pe.y}px`,transform:"translate(-50%, calc(-100% - 10px))"},onMouseEnter:s=>{s.stopPropagation()},onMouseLeave:()=>{ae(null)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[V.icon&&e.jsx("img",{src:V.icon,alt:V.name,className:"w-12 h-12 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-yellow-400 mb-1",children:V.name}),V.description&&e.jsx("div",{className:"text-xs text-gray-300 mb-2 leading-relaxed",children:V.description}),e.jsxs("div",{className:"flex flex-col gap-1 mt-2 pt-2 border-t border-slate-700",children:[V.id&&e.jsxs("div",{className:"text-xs text-gray-400",children:[e.jsx("span",{className:"text-gray-500",children:"成就ID:"})," ",V.id]}),V.itemReward&&e.jsxs("div",{className:"text-xs text-gray-400",children:[e.jsx("span",{className:"text-gray-500",children:"獎勵物品:"}),e.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),p?z(V.itemReward).then(l=>{l?p(l):y(`/item/${V.itemReward}`)}):y(`/item/${V.itemReward}`),ae(null)},className:"ml-1 text-ffxiv-gold hover:text-yellow-400 hover:underline pointer-events-auto",children:T[V.itemReward]?.tw||`Item ${V.itemReward}`})]})]})]})]})}),e.jsx(Tt,{isOpen:q.isOpen,onClose:()=>O({...q,isOpen:!1}),zoneName:q.zoneName,x:q.x,y:q.y,npcName:q.npcName,mapId:q.mapId})]})}export{Jt as default};
