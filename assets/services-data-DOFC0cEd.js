import{C as j,a as x}from"./opencc-C1Qz6KEM.js";import{t as F}from"./data-tw-items-4ChDDRSh.js";import{t as U}from"./data-tw-descriptions-CJIEoqIq.js";const O="modulepreload",q=function(e){return"/market_tester/"+e},k={},M=function(l,n,i){let c=Promise.resolve();if(n&&n.length>0){let m=function(r){return Promise.all(r.map(t=>Promise.resolve(t).then(o=>({status:"fulfilled",value:o}),o=>({status:"rejected",reason:o}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),f=s?.nonce||s?.getAttribute("nonce");c=m(n.map(r=>{if(r=q(r),r in k)return;k[r]=!0;const t=r.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${o}`))return;const a=document.createElement("link");if(a.rel=t?"stylesheet":O,t||(a.as="script"),a.crossOrigin="",a.href=r,f&&a.setAttribute("nonce",f),document.head.appendChild(a),t)return new Promise((d,h)=>{a.addEventListener("load",d),a.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${r}`)))})}))}function u(s){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=s,window.dispatchEvent(f),!f.defaultPrevented)throw s}return c.then(s=>{for(const f of s||[])f.status==="rejected"&&u(f.reason);return l().catch(u)})};j({from:"t",to:"cn"});x({from:"cn",to:"t"});function K(e){return e?/[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff]/.test(e):!1}let R=null,E=null,_=!1;const z=new Map;let T=null;async function X(e,l=null){if(!e||e<=0)return null;if(z.has(e))return z.get(e);try{if(l&&l.aborted)return null;T||(T=(await M(()=>import("./data-zh-BCesDonN.js").then(u=>u.z),[])).default);const n=T[e.toString()];if(!n||!n.zh)return null;const i=n.zh.trim();return!i||i===""?null:(z.set(e,i),i)}catch(n){return n.name==="AbortError"||console.error(`Failed to get Simplified Chinese name for item ${e}:`,n),null}}async function H(){if(R&&E)return{items:R,shopItems:E};if(_){for(;_;)await new Promise(e=>setTimeout(e,100));return{items:R,shopItems:E}}_=!0;try{return R=Object.entries(F).map(([l,n])=>{const i=n.tw||"";return{"key: #":l,"9: Name":i,"0: Singular":i,"11: Level{Item}":"","25: Price{Mid}":"","8: Description":"","22: IsUntradable":"False","27: CanBeHq":"True"}}).filter(l=>l["key: #"]&&l["9: Name"].trim()!==""),E=[],_=!1,{items:R,shopItems:E}}catch(e){throw _=!1,console.error("Failed to load item database:",e),e}}function V(e,l){const n=Array.from(e.toLowerCase()),i=Array.from(l.toLowerCase());if(l.toLowerCase().includes(e.toLowerCase()))return 1;let c=0,u=0;for(let f=0;f<n.length;f++){const m=n[f];let r=!1;for(let t=c;t<i.length;t++)if(i[t]===m){u++,r=!0,c=t+1;break}if(!r)return 0}return u/n.length===1?1:0}function N(e,l,n,i,c=!1){const u=i.trim(),s=u.includes(" "),f=s?u.split(/\s+/).filter(r=>r):[u];return e.filter(r=>{let t=r["9: Name"]||"";(!t||t.trim()==="")&&(t=r["0: Singular"]||"");const o=(r["22: IsUntradable"]||"").toString().trim(),a=o==="True"||o==="true"||o==="TRUE"||o==="1";r["key: #"];const d=t.includes("地图");if(!t||t.trim()===""||a)return!1;let h=t.replace(/^["']+|["']+$/g,"").trim();if(!h)return!1;let p=!1;return c&&s?p=f.map(g=>V(g,h)).every(g=>g>0):p=f.every(I=>h.includes(I)),p||d||h.includes("地圖"),p}).map(r=>{const t=r["key: #"];let o=r["9: Name"]||"";(!o||o.trim()==="")&&(o=r["0: Singular"]||"");const a=r["11: Level{Item}"]||"",d=r["25: Price{Mid}"]||"",h=r["27: CanBeHq"]!=="False",p=n.has(t),g=U[t]?.tw||"",w=(r["22: IsUntradable"]||"").toString().trim(),S=!(w==="True"||w==="true"||w==="TRUE"||w==="1"),b=o.replace(/^["']|["']$/g,"").trim(),C=g.replace(/^["']|["']$/g,"").trim();return{id:parseInt(t,10)||0,name:b,nameSimplified:b,itemLevel:a,shopPrice:d,description:C,inShop:p,canBeHQ:h,isTradable:S}}).filter(r=>r.id>0).sort((r,t)=>{const o=(t.isTradable?1:0)-(r.isTradable?1:0);return o!==0?o:r.id-t.id})}async function Z(e,l=!1){if(!e||e.trim()==="")return{results:[],converted:!1,originalText:"",convertedText:null};const{items:n,shopItems:i}=await H(),c=new Set;i.forEach(m=>{const r=m["0: Item"];r&&c.add(r)});const u=e.trim();let s=[];if(l===!0)return u.includes(" "),s=N(n,i,c,u,!0),{results:s,converted:!1,originalText:u,convertedText:null};const f=u.includes(" ");if(s=N(n,i,c,u,!1),s.length===0&&f&&(s=N(n,i,c,u,!0)),s.length===0){T||(T=(await M(()=>import("./data-zh-BCesDonN.js").then(t=>t.z),[])).default);let m=await $(u,!1);m.length===0&&f&&(m=await $(u,!0)),m.length>0&&(s=m.map(t=>n.find(a=>{const d=a["key: #"];return d&&parseInt(d,10)===t})).filter(t=>t!==void 0).map(t=>{const o=t["key: #"];let a=t["9: Name"]||"";(!a||a.trim()==="")&&(a=t["0: Singular"]||"");const d=t["11: Level{Item}"]||"",h=t["25: Price{Mid}"]||"",p=t["27: CanBeHq"]!=="False",I=c.has(o),w=U[o]?.tw||"",y=(t["22: IsUntradable"]||"").toString().trim(),b=!(y==="True"||y==="true"||y==="TRUE"||y==="1"),C=a.replace(/^["']|["']$/g,"").trim(),L=w.replace(/^["']|["']$/g,"").trim();return{id:parseInt(o,10)||0,name:C,nameSimplified:C,itemLevel:d,shopPrice:h,description:L,inShop:I,canBeHQ:p,isTradable:b}}).filter(t=>t.id>0).sort((t,o)=>{const a=(o.isTradable?1:0)-(t.isTradable?1:0);return a!==0?a:t.id-o.id}))}return{results:s,converted:!1,originalText:u,convertedText:null}}async function $(e,l=!1){if(!e||e.trim()==="")return[];try{T||(T=(await M(()=>import("./data-zh-BCesDonN.js").then(f=>f.z),[])).default);const n=e.trim(),i=n.includes(" "),c=i?n.split(/\s+/).filter(s=>s):[n];return Object.entries(T).filter(([s,f])=>{const m=f?.zh||"";if(!m||m.trim()==="")return!1;const r=m.trim();return r?l&&i?c.map(o=>V(o,r)).every(o=>o>0):c.every(t=>r.includes(t)):!1}).map(([s])=>{const f=parseInt(s,10);return f>0?f:null}).filter(s=>s!==null)}catch(n){return console.error("Failed to search simplified database:",n),[]}}async function ee(e){if(!e||e<=0)return null;const{items:l,shopItems:n}=await H(),i=new Set;n.forEach(w=>{const y=w["0: Item"];y&&i.add(y)});const c=l.find(w=>{const y=w["key: #"];return y&&parseInt(y,10)===e});if(!c)return null;const u=c["key: #"];let s=c["9: Name"]||"";(!s||s.trim()==="")&&(s=c["0: Singular"]||"");const f=c["11: Level{Item}"]||"",m=c["25: Price{Mid}"]||"",r=c["27: CanBeHq"]!=="False",t=i.has(u),a=U[u]?.tw||"",d=(c["22: IsUntradable"]||"").toString().trim(),p=!(d==="True"||d==="true"||d==="TRUE"||d==="1"),I=s.replace(/^["']|["']$/g,"").trim(),g=a.replace(/^["']|["']$/g,"").trim();return{id:parseInt(u,10)||0,name:I,nameSimplified:I,itemLevel:f,shopPrice:m,description:g,inShop:t,canBeHQ:r,isTradable:p}}let D=null,v=null,P=!1;async function A(){if(D&&v)return{recipes:D,byResult:v};if(P){for(;P;)await new Promise(e=>setTimeout(e,100));return{recipes:D,byResult:v}}P=!0;try{return D=(await M(()=>import("./data-tw-recipes-Clk2k0CS.js"),[])).default,v=new Map,D.forEach(n=>{n.result&&(v.has(n.result)||v.set(n.result,[]),v.get(n.result).push(n))}),P=!1,{recipes:D,byResult:v}}catch(e){throw P=!1,console.error("Failed to load recipe database:",e),e}}async function Q(e){if(!e||e<=0)return[];const{byResult:l}=await A();return l.get(e)||[]}async function te(e){if(!e||e<=0)return!1;const{byResult:l}=await A();return l.has(e)}const B=new Set([2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]);async function W(e,l=1,n=new Set,i=0,c=!0){if(n.has(e)||i>10)return{itemId:e,amount:l,children:[],isCyclic:n.has(e),maxDepthReached:i>10};const u=await Q(e);if(u.length===0)return{itemId:e,amount:l,children:[],isBaseMaterial:!0};const s=u[0],f=new Set(n);f.add(e);const m=s.yields||1,r=Math.ceil(l/m);let t=c?s.ingredients.filter(a=>!B.has(a.id)):s.ingredients;if(!c&&s.ingredients.length>0){const a=s.ingredients.filter(h=>!B.has(h.id)),d=s.ingredients.filter(h=>B.has(h.id));if(a.length>0&&d.length>0){const h=[],p=d.length,g=a.length-1,w=g>0?Math.floor(p/g):0,y=g>0?p%g:p;let S=0;for(let b=0;b<a.length;b++)if(h.push(a[b]),b<a.length-1){const C=w+(b<y?1:0);for(let L=0;L<C&&S<d.length;L++)h.push(d[S]),S++}for(;S<d.length;)h.push(d[S]),S++;t=h}else d.length>0&&a.length===0&&(t=d)}const o=await Promise.all(t.map(async a=>{const d=a.amount*r;return await W(a.id,d,f,i+1,c)}));return{itemId:e,amount:l,recipeId:s.id,job:s.job,level:s.lvl,yields:m,craftsNeeded:r,children:o,isBaseMaterial:!1}}async function re(e){if(!e||e<=0)return[];const{recipes:l}=await A(),n=new Set;return l.forEach(i=>{i.ingredients&&Array.isArray(i.ingredients)&&i.ingredients.some(u=>u.id===e)&&i.result&&n.add(i.result)}),Array.from(n)}export{M as _,X as a,W as b,K as c,Q as d,re as f,ee as g,te as h,A as l,Z as s};
